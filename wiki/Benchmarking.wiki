= Intro =
Started with <a href="http://www.eishay.com/search/label/protobuf">few blog posts</a> and with the help of many contributes, this project is now benchmarking much more then just protobuf and thrift. Thanks to all who looked at the code, contributed, suggested and pointed bugs. Three major contributions are from <a href="http://www.cowtowncoder.com/blog/blog.html">cowtowncoder</a> who fixed the <a href="http://stax.codehaus.org/">stax</a> code, <a href="http://www.samsarin.com">Chris Pettitt</a> who added the <a href="http://www.json.org/">json</a> code and <a href="http://github.com/davidB">David Bernard</a> for the xstream and java <a href="http://java.sun.com/j2se/1.3/docs/api/java/io/Externalizable.html">externalizable</a>.
The charts below are displaying the latest results. Note that the charts are scaled to best fit the results and they might be misleading in come cases. If you wish to see the numbers scroll down to the chart at the end of the page. Overall we have benchmarks for [http://code.google.com/p/protobuf/ protobuf], [http://incubator.apache.org/thrift/ thrift], [http://java.sun.com/j2se/1.4.2/docs/api/java/io/Serializable.html java], [http://www.scala-lang.org/ scala], few implementations of [http://stax.codehaus.org/ stax], [http://download.oracle.com/docs/cd/B28359_01/appdev.111/b28394/adx_j_xmlbin.htm binaryxml], [http://www.json.org/java/ json], [http://xstream.codehaus.org/ xstream], [http://javolution.org/ javolution], [http://hessian.caucho.com/ hessian], [http://hadoop.apache.org/avro/ avro], [http://code.google.com/p/sbinary/ sbinary], [http://code.google.com/p/jsonmarshaller/ JSON Marshaller], and [http://code.google.com/p/kryo/ Kryo].

= Numbers are not everything =
Benchmarks can be very misleading. Different datasets will provide different results and sometimes the marginal performance boost is eclipsed by other features like <a href="http://www.eishay.com/2009/04/protocol-buffers-forward-backward.html">forward and backward compatibility</a>, cross language support, simpler API, and more. 

= Charts =

==Setup==
The following measurements were performed with revision <a href="http://code.google.com/p/thrift-protobuf-compare/source/browse/?r=121">r121</a> on Windows 7 64-bit using Sun's JVM 1.6.0_15 JRE 32-bit, with an Intel Core i7 920 CPU. Note the tests are run with a JVM heap size of 16MB and using the server HotSpot compiler.

Omitted from the first three charts: json/google-gson and scala. These serializers are so slow, they would break the scale of our charts. See below for the naked data.

==Total Time==
Including creating an object, serializing and deserializing:

<img src='http://chart.apis.google.com/chart?chtt=totalTime&chf=c||lg||0||FFFFFF||1||76A4FB||0|bg||s||EFEFEF&chs=689x430&chd=t:5021.974,5459.2695,5750.351000000001,6062.182,6450.6759999999995,6794.5960000000005,7212.8675,7451.8814999999995,7601.553,8737.444,9271.766,9574.375,10194.773000000001,12571.267,13981.908,15047.8625,21236.4685,23030.0305,25747.9455,31321.9175,63698.646499999995&chds=0,70068.51115&chxt=y&chxl=0:|java|JsonMarshaller|xstream (stax with conv)|binaryxml/FI|hessian|javolution xmlformat|stax/woodstox|json/jackson-databind|protostuff-json|protostuff-numeric-json|stax/aalto|json (jackson)|avro-generic|thrift|sbinary|activemq protobuf|protobuf|avro-specific|kryo|kryo-optimized|java (externalizable)&chm=N *f*,000000,0,-1,10&lklk&chdlp=t&chco=660000|660033|660066|660099|6600CC|6600FF|663300|663333|663366|663399|6633CC|6633FF|666600|666633|666666&cht=bhg&chbh=10&nonsense=aaa.png'/>

==Serialization Time==
Serializing with a new object each time (object creation time included):

<img src='http://chart.apis.google.com/chart?chtt=timeSerializeDifferentObjects&chf=c||lg||0||FFFFFF||1||76A4FB||0|bg||s||EFEFEF&chs=689x430&chd=t:2235.276,3555.4225,3585.5875,3709.513,3717.199,3814.8025,4068.61,4130.2845,4138.546,4216.1685,4299.5535,4548.3665,4609.6565,4771.0485,4945.6975,6144.608,7739.889,8877.701,10279.3115,12108.034,12275.382&chds=0,13502.9202&chxt=y&chxl=0:|java|binaryxml/FI|JsonMarshaller|xstream (stax with conv)|hessian|json/jackson-databind|stax/woodstox|avro-generic|protostuff-json|javolution xmlformat|protostuff-numeric-json|json (jackson)|activemq protobuf|sbinary|protobuf|stax/aalto|kryo|avro-specific|thrift|kryo-optimized|java (externalizable)&chm=N *f*,000000,0,-1,10&lklk&chdlp=t&chco=660000|660033|660066|660099|6600CC|6600FF|663300|663333|663366|663399|6633CC|6633FF|666600|666633|666666&cht=bhg&chbh=10&nonsense=aaa.png'/>

==Deserialization Time==
Often the most expensive operation. To make a fair comparison, all fields of the deserialized instances are accessed - this forces lazy deserializers to really do their work. The raw data below shows additional measurements for deserialization.

<img src='http://chart.apis.google.com/chart?chtt=timeDeserializeAndCheckAllFields&chf=c||lg||0||FFFFFF||1||76A4FB||0|bg||s||EFEFEF&chs=689x430&chd=t:1903.847,2033.152,2352.669,2382.066,2656.05,2786.698,2830.5045,3082.583,3866.294,4521.2755,5274.8215,5456.9635,5585.1165,6426.659,9036.2105,10499.496,10921.9965,13496.5795,16870.2445,21042.606,51423.2645&chds=0,56565.590950000005&chxt=y&chxl=0:|java|JsonMarshaller|xstream (stax with conv)|hessian|binaryxml/FI|javolution xmlformat|stax/woodstox|json/jackson-databind|protostuff-json|stax/aalto|protostuff-numeric-json|json (jackson)|thrift|sbinary|avro-generic|java (externalizable)|activemq protobuf|protobuf|avro-specific|kryo|kryo-optimized&chm=N *f*,000000,0,-1,10&lklk&chdlp=t&chco=660000|660033|660066|660099|6600CC|6600FF|663300|663333|663366|663399|6633CC|6633FF|666600|666633|666666&cht=bhg&chbh=10&nonsense=aaa.png'/>

==Serialization Size==
May vary a lot depending on number of repetitions in lists, usage of number compacting in protobuf, strings vs numerics, assumptions that can be made about the object graph, and more. Interesting point is Scala and Java which holds the name of the classes in the serialized form. I.e. longer class names = larger serialized form. In Scala its worse since the Scala compiler creates more implicit classes then java.

<img src='http://chart.apis.google.com/chart?chtt=length&chf=c||lg||0||FFFFFF||1||76A4FB||0|bg||s||EFEFEF&chs=689x430&chd=t:207.0,211.0,211.0,226.0,231.0,231.0,264.0,273.0,300.0,353.0,359.0,370.0,378.0,399.0,419.0,448.0,465.0,470.0,475.0,475.0,526.0,919.0,2024.0&chds=0,2226.4&chxt=y&chxl=0:|scala|java|hessian|stax/woodstox|stax/aalto|json/google-gson|json/jackson-databind|protostuff-json|javolution xmlformat|xstream (stax with conv)|json (jackson)|JsonMarshaller|protostuff-numeric-json|thrift|binaryxml/FI|java (externalizable)|sbinary|protobuf|activemq protobuf|kryo|avro-specific|avro-generic|kryo-optimized&chm=N *f*,000000,0,-1,10&lklk&chdlp=t&chco=660000|660033|660066|660099|6600CC|6600FF|663300|663333|663366|663399|6633CC|6633FF|666600|666633|666666&cht=bhg&chbh=10&nonsense=aaa.png'/>

==Object Creation Time==
Object creation is not so meaningful since it takes in average 100 nano to create an object. The surprise comes from <a href="http://code.google.com/p/protobuf/">protobuf</a> which takes a very long time to create an object. Its the only point in this set of benchmarks where it didn't perform as well as <a href="http://incubator.apache.org/thrift/">thrift</a>. Scala (and to a lesser point - java) on the other hand is fast, seems like its a good language to handle in memory data structures but when coming to serialization you might want to check the alternatives.

<img src='http://chart.apis.google.com/chart?chtt=timeCreate&chf=c||lg||0||FFFFFF||1||76A4FB||0|bg||s||EFEFEF&chs=689x430&chd=t:63.0062,63.909225,78.636225,80.976405,81.38757,81.86214,82.38666,82.40972,82.549975,82.619145,82.638355,82.65757,82.851625,83.06105,83.318505,84.515495,133.820685,148.67257,197.23997,198.588745,198.60027,1600.44736,2591.515865&chds=0,2850.6674515&chxt=y&chxl=0:|avro-generic|avro-specific|protostuff-json|protobuf|protostuff-numeric-json|thrift|activemq protobuf|json/google-gson|javolution xmlformat|xstream (stax with conv)|stax/aalto|JsonMarshaller|binaryxml/FI|json (jackson)|java|json/jackson-databind|stax/woodstox|hessian|kryo|kryo-optimized|java (externalizable)|sbinary|scala&chm=N *f*,000000,0,-1,10&lklk&chdlp=t&chco=660000|660033|660066|660099|6600CC|6600FF|663300|663333|663366|663399|6633CC|6633FF|666600|666633|666666&cht=bhg&chbh=10&nonsense=aaa.png'/>

= Numbers =
Times are in nanoseconds, sizes are in bytes.
{{{
                        ,   Object create,       Serialize,  /w Same Object,     Deserialize, and Check Media,   and Check All,      Total Time, Serialized Size
avro-generic            ,      2591.51587,      4771.04850,      2140.16750,      2830.50450,      2830.50450,      2830.50450,      7601.55300,        211
avro-specific           ,      1600.44736,      3709.51300,      1494.60200,      2352.66900,      2352.66900,      2352.66900,      6062.18200,        211
activemq protobuf       ,       133.82069,      4138.54600,        52.25800,        11.52800,      1396.42450,      2656.05000,      6794.59600,        231
protobuf                ,       198.58875,      4068.61000,      2117.31150,      2041.02950,      2181.09250,      2382.06600,      6450.67600,        231
thrift                  ,       148.67257,      3585.58750,      3446.87100,      3866.29400,      3866.29400,      3866.29400,      7451.88150,        353
hessian                 ,        81.86214,      7739.88900,      7194.61450,     13496.57950,     13496.57950,     13496.57950,     21236.46850,        526
kryo                    ,        81.38757,      3717.19900,      3767.15050,      2033.15200,      2033.15200,      2033.15200,      5750.35100,        226
kryo-optimized          ,        80.97641,      3555.42250,      3575.98150,      1903.84700,      1903.84700,      1903.84700,      5459.26950,        207
java                    ,        82.54998,     12275.38200,     11419.04600,     51423.26450,     51423.26450,     51423.26450,     63698.64650,        919
java (externalizable)   ,        78.63623,      2235.27600,      2261.59350,      2786.69800,      2786.69800,      2786.69800,      5021.97400,        273
scala                   ,        63.00620,     29948.16650,     28763.09350,    136943.42400,    136943.42400,    136943.42400,    166891.59050,       2024
json (jackson)          ,        82.61915,      4216.16850,      4278.99750,      4521.27550,      4521.27550,      4521.27550,      8737.44400,        378
json/jackson-databind   ,        82.40972,      6144.60800,      6127.50900,      6426.65900,      6426.65900,      6426.65900,     12571.26700,        465
JsonMarshaller          ,        82.65757,     10279.31150,     10172.67450,     21042.60600,     21042.60600,     21042.60600,     31321.91750,        370
protostuff-json         ,       198.60027,      4609.65650,      4525.69700,      5585.11650,      5585.11650,      5585.11650,     10194.77300,        448
protostuff-numeric-json ,       197.23997,      4299.55350,      4224.62050,      5274.82150,      5274.82150,      5274.82150,      9574.37500,        359
json/google-gson        ,        84.51550,    228243.71550,    228869.87700,    283704.46400,    283704.46400,    283704.46400,    511948.17950,        470
stax/woodstox           ,        82.38666,      4945.69750,      5060.59100,      9036.21050,      9036.21050,      9036.21050,     13981.90800,        475
stax/aalto              ,        82.85163,      3814.80250,      3864.36800,      5456.96350,      5456.96350,      5456.96350,      9271.76600,        475
binaryxml/FI            ,        82.63836,     12108.03400,     12176.43800,     10921.99650,     10921.99650,     10921.99650,     23030.03050,        300
xstream (stax with conv),        83.06105,      8877.70100,      8174.30250,     16870.24450,     16870.24450,     16870.24450,     25747.94550,        399
javolution xmlformat    ,        83.31851,      4548.36650,      4477.47150,     10499.49600,     10499.49600,     10499.49600,     15047.86250,        419
sbinary                 ,        63.90923,      4130.28450,      4221.73750,      3082.58300,      3082.58300,      3082.58300,      7212.86750,        264
}}}